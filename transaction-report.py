import json
mydata = [{'date': '2021-07-14', 'dumpedTransaction': '[{"Transaction_id": 1, "Pump_name": "Pump2", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 2, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 3, "Pump_name": "Pump2", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fa", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 4, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 5, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 6, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 7, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 8, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 200.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 9, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 10, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 11, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 12, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 13, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 14, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 15, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 16, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 17, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 18, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 19, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 20, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 21, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 22, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 23, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 24, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 25, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 26, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 27, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 28, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 29, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 32, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": null, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 33, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 34, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 35, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": null, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 36, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 37, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 39, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}, {"Transaction_id": 40, "Pump_name": "Pump1", "local_id": null, "Nozzle_address": "1", "Transaction_start_time": "21-07-14 12:00:00 PM", "Transaction_stop_time": "21-07-14 12:05:00 PM", "Transaction_raw_volume": 20.0, "Transaction_raw_amount": 800.0, "Raw_transaction_price_per_unit": 160.0, "Pump_mac_address": "b8:27:eb:fb:31:fc", "Transaction_start_pump_totalizer_volume": 150000.0, "Transaction_stop_pump_totalizer_volume": 150020.0, "Transaction_start_pump_totalizer_amount": 2000000.0, "Transaction_stop_pump_totalizer_amount": 2003200.0, "Product_name": "PMS", "Device": 1, "Site": 1}]'}, {'date': '2021-07-16', 'dumpedTransaction': '[]'}, {'date': '2021-07-15', 'dumpedTransaction': '[]'}]
'''
Desired Output Format

'PMS'
[
    {'Pump': 'Pump2', 'Nozzle': '1', 'Volume': '720.0', 'Price': '160.0', 'Value(N)': '24600.0'},
    {'Pump': 'Pump1', 'Nozzle': '1', 'Volume': '20.0',  'Price': '160.0', 'Value(N)': '200.0'},
    {'Pump': '',      'Nozzle': '',  'Volume': '740.0', 'Price': '',      'Value(N)': '24800.0'}
]

'AGO'
[
    {'Pump': 'Pump2', 'Nozzle': '1', 'Volume': '720.0', 'Price': '160.0', 'Value(N)': '24600.0'},
    {'Pump': '',      'Nozzle': '',  'Volume': '720.0', 'Price': '',      'Value(N)': '24800.0'}
]

'''

sales_transaction_details = []

trx_data = (json.loads(mydata[0]['dumpedTransaction']))

filtered_product_data = filter(
    lambda trx: trx['Product_name'] == 'PMS', trx_data)  # filter product
filtered_product_data_list = list(filtered_product_data)
print('all lenght', len(filtered_product_data_list))
# initialize set() for unique values
all_unique_pumps = set()
all_unique_nozzles = set()
all_unique_price_change = set()
pump_name_to_mac_add = {}

for eachTransaction in filtered_product_data_list:
    all_unique_pumps.add(eachTransaction['Pump_mac_address'])
    all_unique_nozzles.add(eachTransaction['Nozzle_address'])
    all_unique_price_change.add(
        eachTransaction['Raw_transaction_price_per_unit'])
    pump_name_to_mac_add[f'{eachTransaction["Pump_mac_address"]}'] = f'{eachTransaction["Pump_name"]}'


unique_pumps = list(all_unique_pumps)
unique_nozzles = sorted(all_unique_nozzles)
unique_price_change = list(all_unique_price_change)

for eachPump in unique_pumps:
    for eachNozzle in unique_nozzles:
        for eachPriceChange in unique_price_change:
            #print('Pump', eachPump,'nozz',eachNozzle,  'price', eachPriceChange)

            newTransactionData = filter(lambda mytrx: mytrx['Nozzle_address'] == f'{eachNozzle}' and mytrx['Pump_mac_address']
                                        == f'{eachPump}' and mytrx['Raw_transaction_price_per_unit'] == eachPriceChange, filtered_product_data_list)

            this_transactions = list(newTransactionData)
            print('this length', len(this_transactions))
            #print('this_transaction', type(this_transactions))
            from functools import reduce

            this_amount = reduce(
                lambda x, y: x + y['Transaction_raw_amount'], this_transactions, 0)

            this_vol = reduce(
                lambda x, y: x + y['Transaction_raw_volume'], this_transactions, 0)
            print('vol', this_vol, 'amount', this_amount)

            if (this_vol == 0 and this_amount == 0):
                continue
            sales_transaction_details.append(
                {
                    "Pump": f'{pump_name_to_mac_add[eachPump]}',
                    "Nozzle": f'{eachNozzle}',
                    "Volume": f'{this_vol}',
                    "Price": f'{eachPriceChange}',
                    "Value(N)": f'{this_amount}',
                }
            )
if len(sales_transaction_details) > 1:
    print('lenght greater than one', len(sales_transaction_details))
    total_col_volume = reduce(
        lambda x, y: x + y['Transaction_raw_volume'], filtered_product_data_list, 0)
    total_col_amount = reduce(
        lambda x, y: x + y['Transaction_raw_amount'], filtered_product_data_list, 0)
    print('col vol:::>', total_col_volume, 'col amount:::>', total_col_amount)
    sales_transaction_details.append(
        {
            "Pump": f'',
                    "Nozzle": f'',
                    "Volume": f'{total_col_volume}',
                    "Price": f'',
                    "Value(N)": f'{total_col_amount}',
        }
    )

print('-----------------------------------')
print('U Pumps:::', unique_pumps)
print('U Nozzles:::', unique_nozzles)
print('U Price changes:::', unique_price_change)
print('U pump name map', pump_name_to_mac_add)
print('sales summary', sales_transaction_details)


# filter for a particular products i.e PMS
# get all distinct pumps
# get all distinct nozzles
# get unique price change
